{"primaryContentSections":[{"kind":"content","content":[{"anchor":"Overview","level":2,"type":"heading","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"A "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" represents a data storage mechanism for saving and persisting data. A "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" is a construct you can build that plugs into "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/ObjectStorage"},{"type":"text","text":" to use for persisting data, "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/ObjectStorage"},{"type":"text","text":" providing a higher-level abstraction which allows you to interface with Swift types rather than "},{"type":"codeVoice","code":"Data"},{"type":"text","text":" so you don’t ever have to think about databases, persistence layers, or servers."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"This library has two implementations of "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":", "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":" and "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine"},{"type":"text","text":" which we’ll discuss below. Both of these can serve as inspiration if you have your own persistence mechanism (such as Realm, CoreData, CloudKit, etc)."}]},{"type":"paragraph","inlineContent":[{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":" takes "},{"type":"codeVoice","code":"Data"},{"type":"text","text":" and saves it to disk using file system operations. "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine"},{"type":"text","text":" takes "},{"type":"codeVoice","code":"Data"},{"type":"text","text":" and saves it to an SQLite database under the hood. This is fundamentally how a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" works, the protocol provides a blueprint for how to map Swift values and objects to "},{"type":"codeVoice","code":"Data"},{"type":"text","text":", and how to map "},{"type":"codeVoice","code":"Data"},{"type":"text","text":" back to Swift types."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"If your app already has a persistence layer then all you need to do is conform to the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" protocol. You can turn to the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/Building-A-StorageEngine"},{"type":"text","text":" tutorial to learn how to create your own "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":", or you can use "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":" and "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine"},{"type":"text","text":" as references."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"For now let’s discuss Bodega’s built-in "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" options."}]},{"anchor":"Which-StorageEngine-Is-Right-For-You?","level":2,"type":"heading","text":"Which StorageEngine Is Right For You?"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The answer should almost always be "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine"},{"type":"text","text":". The reason why is simple, it’s significantly faster. If your app is storing any meaningful amount of objects then a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":"-backed "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/ObjectStorage"},{"type":"text","text":" will end up feeling a bit slow. But if you’re not worried about performance and would prefer the ability to inspect the output without an SQLite editor, then using "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":" is a reasonable choice."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"If your app already has a persistence layer it may make sense to build your own "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":". If you’d like to explore that option you can read through the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/Building-A-StorageEngine"},{"type":"text","text":" tutorial, or use "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":" and "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine"},{"type":"text","text":" as references."}]},{"anchor":"DiskStorageEngine","level":2,"type":"heading","text":"DiskStorageEngine"},{"type":"paragraph","inlineContent":[{"type":"text","text":"In Bodega v1 there was no concept of a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":", everyone was implicitly using a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":". In v2 we created the new "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" abstraction, and rebuilt "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":" by conforming to the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" protocol."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":" prioritizes simplicity over speed, it’s a very easy to use and understand concept. The "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":" will write a one file for every object you save, which makes it easy to inspect and debug any objects you’re saving. The downside of using "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":" is performance."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Initialization times vary based on the total number of objects you have saved, but a rule of thumb is that loading 1,000 objects from disk takes about 0.25 seconds. This can start to feel a bit slow if you are saving more than 2,000-3,000, at which point"},{"type":"text","text":" "},{"type":"text","text":"it may be worth investigating an alternative "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":". By comparison if you’re using "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine"},{"type":"text","text":" it only takes about 0.1 seconds to load 1,000 objects, the difference only growing more the more objects you have. Since "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":" is backed by files, every operating system write or remove operation carries additional overhead, saving 10 files to disk requires 10 separate writes. This is different than an alternative like "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine"},{"type":"text","text":" where you only have one database that you write to and read from. This may not sound like a big difference but when you look at how it scales you can see that "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":" is a subpar choice for a larger app."}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"StorageEngine-Read-Performance"},{"type":"text","text":" "},{"type":"image","identifier":"StorageEngine-Write-Performance"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"If performance is important "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega"},{"type":"text","text":" ships "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine"},{"type":"text","text":", and that is the recommended"},{"type":"text","text":" "},{"type":"text","text":"default "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":". If you have your own persistence layer such as Core Data, Realm, etc,"},{"type":"text","text":" "},{"type":"text","text":"you can easily build your own "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" to plug into "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/ObjectStorage"},{"type":"text","text":"."}]},{"anchor":"SQLiteStorageEngine","level":2,"type":"heading","text":"SQLiteStorageEngine"},{"type":"paragraph","inlineContent":[{"type":"text","text":"As the name implies, "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine"},{"type":"text","text":" is a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" based on an SQLite database. "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine"},{"type":"text","text":" is Bodega’s default "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":", If you’re not using your own persistence mechanism such as Core Data, Realm, etc, it is highly recommended you use "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine"},{"type":"text","text":" to power your "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/ObjectStorage"},{"type":"text","text":" (or Store if you’re using "},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/mergesort\/Boutique"},{"type":"text","text":")."}]},{"type":"paragraph","inlineContent":[{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine"},{"type":"text","text":" is the default because it is significantly faster than "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":". As much as "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine"},{"type":"text","text":" was optimized, file system operations like writing and removing files have a relatively high cost per operation. SQLite on the other hand "},{"type":"reference","isActive":true,"identifier":"https:\/\/www.sqlite.org\/fasterthanfs.html"},{"type":"text","text":" to be significantly faster than files for storing data."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The simplest way to get started with "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine"},{"type":"text","text":" is to use one of the defaults, "},{"type":"codeVoice","code":"SQLiteStorageEngine.default"},{"type":"text","text":", or "},{"type":"codeVoice","code":"SQLiteStorageEngine.default(appendingPath:)"},{"type":"text","text":". This will create an "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine"},{"type":"text","text":" in a platform-specific default storage directory, equivalent to "},{"type":"codeVoice","code":"SQLiteStorageEngine(directory: .defaultStorageDirectory(appendingPath: \"Your Path\"))"},{"type":"text","text":"."}]}]}],"schemaVersion":{"major":0,"minor":2,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/bodega\/using-storageengines"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/Bodega\/documentation\/Bodega\/Using-StorageEngines","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"The "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" is at the heart of what makes Bodega, Bodega."}],"kind":"article","metadata":{"modules":[{"name":"Bodega"}],"role":"collectionGroup","title":"Using StorageEngines"},"hierarchy":{"paths":[["doc:\/\/Bodega\/documentation\/Bodega"]]},"topicSections":[{"title":"Referenced","identifiers":["doc:\/\/Bodega\/documentation\/Bodega\/Building-A-StorageEngine"]}],"references":{"https://www.sqlite.org/fasterthanfs.html":{"title":"has been shown","titleInlineContent":[{"type":"text","text":"has been shown"}],"type":"link","identifier":"https:\/\/www.sqlite.org\/fasterthanfs.html","url":"https:\/\/www.sqlite.org\/fasterthanfs.html"},"doc://Bodega/documentation/Bodega":{"role":"collection","title":"Bodega","abstract":[{"type":"text","text":"A simple store all your basic needs, but surprisingly so much more. 🐱"}],"identifier":"doc:\/\/Bodega\/documentation\/Bodega","kind":"symbol","type":"topic","url":"\/documentation\/bodega"},"https://github.com/mergesort/Boutique":{"title":"Boutique","titleInlineContent":[{"type":"text","text":"Boutique"}],"type":"link","identifier":"https:\/\/github.com\/mergesort\/Boutique","url":"https:\/\/github.com\/mergesort\/Boutique"},"doc://Bodega/documentation/Bodega/ObjectStorage":{"role":"symbol","title":"ObjectStorage","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"ObjectStorage"}],"abstract":[{"type":"text","text":"An unified layer over a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" primitives, allowing you to read, write, and save Swift objects."}],"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/ObjectStorage","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"ObjectStorage"}],"url":"\/documentation\/bodega\/objectstorage"},"doc://Bodega/documentation/Bodega/DiskStorageEngine":{"role":"symbol","title":"DiskStorageEngine","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"DiskStorageEngine"}],"abstract":[{"type":"text","text":"A "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" based on saving items to the file system."}],"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/DiskStorageEngine","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"DiskStorageEngine"}],"url":"\/documentation\/bodega\/diskstorageengine"},"StorageEngine-Write-Performance":{"alt":"StorageEngine Write Performance","type":"image","identifier":"StorageEngine-Write-Performance","variants":[{"url":"\/images\/StorageEngine-Write-Performance.png","traits":["1x","light"]}]},"doc://Bodega/documentation/Bodega/SQLiteStorageEngine":{"role":"symbol","title":"SQLiteStorageEngine","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"SQLiteStorageEngine"}],"abstract":[{"type":"text","text":"A "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" based on an SQLite database."}],"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/SQLiteStorageEngine","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"SQLiteStorageEngine"}],"url":"\/documentation\/bodega\/sqlitestorageengine"},"StorageEngine-Read-Performance":{"alt":"StorageEngine Read Performance","type":"image","identifier":"StorageEngine-Read-Performance","variants":[{"url":"\/images\/StorageEngine-Read-Performance.png","traits":["1x","light"]}]},"doc://Bodega/documentation/Bodega/Building-A-StorageEngine":{"role":"collectionGroup","title":"Building A StorageEngine","abstract":[{"type":"text","text":"Learn how to build a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" for a persistence layer such as Core Data, Realm, or any way your app stores data."}],"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/Building-A-StorageEngine","kind":"article","type":"topic","url":"\/documentation\/bodega\/building-a-storageengine"},"doc://Bodega/documentation/Bodega/StorageEngine":{"role":"symbol","title":"StorageEngine","fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"StorageEngine"}],"abstract":[{"type":"text","text":"A "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine"},{"type":"text","text":" represents a data storage mechanism for saving and persisting data."}],"identifier":"doc:\/\/Bodega\/documentation\/Bodega\/StorageEngine","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"StorageEngine"}],"url":"\/documentation\/bodega\/storageengine"}}}